



Network Working Group                                           S. Bosch
Internet-Draft
Intended status: Standards Track                       February 17, 2016
Expires: August 20, 2016


       Sieve Email Filtering: Delivering to Special-Use Mailboxes
                    draft-bosch-sieve-special-use-00

Abstract

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 20, 2016.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.









Bosch                    Expires August 20, 2016                [Page 1]

Internet-Draft        Sieve: Special-Use Mailboxes         February 2016


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   2
   3.  Test "specialuse_exists"  . . . . . . . . . . . . . . . . . .   2
   4.  ":specialuse" Argument to "fileinto" Command  . . . . . . . .   3
     4.1.  Interaction with ":create" Argument to "fileinto" Command   4
   5.  Sieve Capability Strings  . . . . . . . . . . . . . . . . . .   4
   6.  Examples  . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   9.  Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   This is an extension to the Sieve filtering language defined by RFC
   5228 [SIEVE].  [FIXME]

2.  Conventions Used in This Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [KEYWORDS].

   Conventions for notations are as in [SIEVE] Section 1.1, including
   use of the "Usage:" label for the definition of action and tagged
   arguments syntax.

3.  Test "specialuse_exists"

   Usage:  specialuse_exists [<mailbox: string>]
                             <special-use-flags: string-list>

   If the "mailbox" string argument is omitted, the "specialuse_exists"
   test yields true if for each of the special-use flags listed in the
   "special-use-flags" argument:

   a.  at least one mailbox exists in the mail store that has that
       particular special-use flag assigned, and

   b.  that mailbox allows the user in whose context the Sieve script
       runs to "deliver" messages into it.

   If the "mailbox" argument is specified, the "specialuse_exists" test
   yields true if:

   a.  the indicated mailbox exists,



Bosch                    Expires August 20, 2016                [Page 2]

Internet-Draft        Sieve: Special-Use Mailboxes         February 2016


   b.  that mailbox allows the user in whose context the Sieve script
       runs to "deliver" messages into it, and

   c.  that mailbox has all of the special-use flags listed in the
       "special-use-flags" argument assigned to it.

   Refer to the specification of the "mailboxexists" test in Section 3.1
   of RFC 5490 [MAILBOX] for a definition of when "delivery" of messages
   into a mailbox is deemed possible.

4.  ":specialuse" Argument to "fileinto" Command

   Usage:  fileinto [:specialuse <special-use-flag: string>]
                    <mailbox: string>

   Normally, the "fileinto" command delivers the message in the mailbox
   specified using its positional mailbox argument.  However, if the
   optional ":specialuse" argument is also specified, the "fileinto"
   command first checks whether a mailbox exists with the specified
   special-use flag assigned to it.  If that is the case, that special-
   use mailbox is used for delivery instead.  If there is no such
   mailbox or if the specified special-use flag is unknown to the
   implementation in general, the "fileinto" action proceeds as it would
   without the ":specialuse" argument.

   Summarizing, if the ":specialuse" argument is specified, the fileinto
   command deals with two mailboxes that may or may not exist:

   o  An anonymous special-use mailbox, which has at least the special-
      use flag specified with the ":specialuse" argument assigned to it.

   o  The default mailbox named by the positional string argument of the
      "fileinto" command, which is used when the special-use mailbox is
      not found.

   The special-use flag specified with the ":specialuse" argument MUST
   conform to the "use-attr" syntax described in Section (FIXME) of
   [RFC6154] (FIXME).  Implementations SHOULD handle an invalid special-
   use flag in the same way as an invalid mailbox name is handled.  The
   string parameter of the ":specialuse" argument is not a constant
   string, which means that variable substitutions are allowed when the
   "variables" extension [VARIABLES] is active.  In that case, the
   syntax of the special-use flag is only verified at runtime.

   If neither the special-use mailbox nor the default mailbox exists,
   the "fileinto" action MUST proceed exactly as it does in case the
   ":specialuse" is argument is absent and the mailbox named by its




Bosch                    Expires August 20, 2016                [Page 3]

Internet-Draft        Sieve: Special-Use Mailboxes         February 2016


   positional argument does not exist.  The various options for handling
   this situation are described in Section 4.1 of RFC5228 [SIEVE].

   More than one mailbox can have a particular special-use flag
   assigned.  In that case, the mailbox that is chosen for delivery is
   implementation-defined.  However, implementations MUST ensure that
   this choice is made consistently, so that the same mailbox is used
   every time.

   If delivery to the special-use mailbox fails for reasons not relating
   to its existence, the Sieve interpreter MUST NOT subsequently attempt
   delivery in the indicated default mailbox as a fallback.  Instead, it
   MUST proceed exactly as it does in case the ":specialuse" argument is
   absent and delivery to the mailbox named by its positional argument
   fails.  This prevents the situation where messages are unexpectedly
   spread over two mailboxes in case transient or intermittent delivery
   failures occur.

4.1.  Interaction with ":create" Argument to "fileinto" Command

   The "mailbox" extension [MAILBOX] adds the optional ":create"
   argument to the "fileinto" command.  If the optional ":create"
   argument is specified with "fileinto", it instructs the Sieve
   interpreter to create the specified mailbox if needed, before
   attempting to deliver the message into the specified mailbox.

   When combined with the ":specialuse" argument, the ":create" argument
   instructs the Sieve interpreter to create the specified default
   mailbox if needed.  This need arises when both the special-use and
   the default mailbox are not found.

   If the server implementation supports the CREATE-SPECIAL-USE
   capability for IMAP [FIXME], i.e. it allows assigning special-use
   flags to new mailboxes, it SHOULD assign the special-use flag
   specified with the ":specialuse" argument to the newly created
   mailbox.

5.  Sieve Capability Strings

   A Sieve implementation that defines the "specialuse_exists" test and
   the ":specialuse" argument for the "fileinto" command will advertise
   the capability string "special-use".

6.  Examples

   [FIXME]





Bosch                    Expires August 20, 2016                [Page 4]

Internet-Draft        Sieve: Special-Use Mailboxes         February 2016


7.  Security Considerations

   [FIXME]

   Additional security considerations are discussed in [SIEVE].

8.  IANA Considerations

   The following template specifies the IANA registration of the Sieve
   extension specified in this document:

      To: iana@iana.org
      Subject: Registration of new Sieve extension

      Capability name: special-use
      Description:
      RFC number:      this RFC
      Contact address: Sieve mailing list <sieve@ietf.org>

   This information should be added to the list of sieve extensions
   given on http://www.iana.org/assignments/sieve-extensions.

9.  Normative References

   [KEYWORDS]
              Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [MAILBOX]  Melnikov, A., "The Sieve Mail-Filtering Language --
              Extensions for Checking Mailbox Status and Accessing
              Mailbox Metadata", RFC 5490, March 2009.

   [SIEVE]    Guenther, P. and T. Showalter, "Sieve: An Email Filtering
              Language", RFC 5228, January 2008.

   [VARIABLES]
              Homme, K., "Sieve Email Filtering: Variables Extension",
              RFC 5229, January 2008.

Author's Address

   Stephan Bosch
   Enschede
   NL

   Email: stephan@rename-it.nl





Bosch                    Expires August 20, 2016                [Page 5]
